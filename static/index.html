<!doctype html>
<html lang="pl"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Mini‑CRUD Students (Flask)</title><style>body{font-family:system-ui,sans-serif;margin:24px;max-width:900px}.card{border:1px solid #ddd;border-radius:12px;padding:16px;box-shadow:0 1px 3px rgba(0,0,0,.06)}.row{display:flex;gap:8px;align-items:center;margin-bottom:8px}.row>span{width:160px}table{border-collapse:collapse;width:100%;margin-top:12px}th,td{border:1px solid #eee;padding:8px;text-align:left}.muted{color:#666;font-size:.9rem}button{cursor:pointer}</style></head><body><h1>Mini‑CRUD „Studenci” — Flask</h1><p class="muted">API: <code>/api/students</code> • Test: <code>/healthz</code></p><div class="card"><form id="form"><input type="hidden" id="id"/><div class="row"><span>Imię</span><input id="first_name" required/></div><div class="row"><span>Nazwisko</span><input id="last_name" required/></div><div class="row"><span>Grupa</span><input id="group_code" required/></div><div class="row"><button type="submit">Zapisz</button><button type="button" id="resetBtn">Wyczyść</button></div></form></div><div style="height:16px"></div><div class="card"><table id="tbl"><thead><tr><th>ID</th><th>Imię</th><th>Nazwisko</th><th>Grupa</th><th>Akcje</th></tr></thead><tbody></tbody></table></div><script>async function load(){const e=await fetch("/api/students/");const t=await e.json();const n=document.querySelector("#tbl tbody");n.innerHTML="";t.forEach(e=>{const t=document.createElement("tr");t.innerHTML=`
      <td>${e.id}</td>
      <td>${e.first_name}</td>
      <td>${e.last_name}</td>
      <td>${e.group_code}</td>
      <td>
        <button onclick='edit(${JSON.stringify(e).replaceAll("'","&#39;")})'>Edytuj</button>
        <button onclick='del(${e.id})'>Usuń</button>
      </td>`;n.appendChild(t)})}function edit(e){document.getElementById("id").value=e.id,document.getElementById("first_name").value=e.first_name,document.getElementById("last_name").value=e.last_name,document.getElementById("group_code").value=e.group_code,window.scrollTo({top:0,behavior:"smooth"})}async function del(e){if(!confirm("Na pewno usunąć?"))return;const t=await fetch("/api/students/"+e,{method:"DELETE"});204===t.status?load():alert("Błąd usuwania")}function collect(){return{first_name:document.getElementById("first_name").value,last_name:document.getElementById("last_name").value,group_code:document.getElementById("group_code").value}}document.getElementById("form").addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("id").value,n=JSON.stringify(collect()),a={headers:{"Content-Type":"application/json"},body:n},d="/api/students/"+(t?t:""),o=t?"PUT":"POST",l=await fetch(d,{...a,method:o});if(l.ok)e.target.reset(),document.getElementById("id").value="",load();else{const t=await l.json().catch(()=>({detail:"Błąd"}));alert("Błąd: "+JSON.stringify(t))}}),document.getElementById("resetBtn").onclick=()=>document.getElementById("form").reset(),load();</script></body></html>